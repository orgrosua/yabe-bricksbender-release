/**
* @vue/shared v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function St(t,e){const i=new Set(t.split(","));return e?n=>i.has(n.toLowerCase()):n=>i.has(n)}const Tt={},ne=()=>{},_t=Object.prototype.hasOwnProperty,pe=(t,e)=>_t.call(t,e),C=Array.isArray,G=t=>Ee(t)==="[object Map]",xt=t=>Ee(t)==="[object Set]",F=t=>typeof t=="function",Ct=t=>typeof t=="string",ye=t=>typeof t=="symbol",Y=t=>t!==null&&typeof t=="object",It=t=>(Y(t)||F(t))&&F(t.then)&&F(t.catch),Lt=Object.prototype.toString,Ee=t=>Lt.call(t),At=t=>Ee(t).slice(8,-1),Rt=t=>Ee(t)==="[object Object]",Re=t=>Ct(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,D=(t,e)=>!Object.is(t,e);let He;const Mt=()=>He||(He=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});/**
* @vue/reactivity v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Nt;function kt(t,e=Nt){e&&e.active&&e.effects.push(t)}let z;class Ve{constructor(e,i,n,r){this.fn=e,this.trigger=i,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,kt(this,r)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Qe();for(let e=0;e<this._depsLength;e++){const i=this.deps[e];if(i.computed&&(Pt(i.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Ze()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=k,i=z;try{return k=!0,z=this,this._runnings++,We(this),this.fn()}finally{Fe(this),this._runnings--,z=i,k=e}}stop(){var e;this.active&&(We(this),Fe(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function Pt(t){return t.value}function We(t){t._trackId++,t._depsLength=0}function Fe(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)Ge(t.deps[e],t);t.deps.length=t._depsLength}}function Ge(t,e){const i=t.get(e);i!==void 0&&e._trackId!==i&&(t.delete(e),t.size===0&&t.cleanup())}let k=!0,Te=0;const Je=[];function Qe(){Je.push(k),k=!1}function Ze(){const t=Je.pop();k=t===void 0?!0:t}function Me(){Te++}function Ne(){for(Te--;!Te&&_e.length;)_e.shift()()}function et(t,e,i){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const n=t.deps[t._depsLength];n!==e?(n&&Ge(n,t),t.deps[t._depsLength++]=e):t._depsLength++}}const _e=[];function tt(t,e,i){Me();for(const n of t.keys()){let r;n._dirtyLevel<e&&(r??(r=t.get(n)===n._trackId))&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n._dirtyLevel=e),n._shouldSchedule&&(r??(r=t.get(n)===n._trackId))&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==2&&(n._shouldSchedule=!1,n.scheduler&&_e.push(n.scheduler)))}Ne()}const it=(t,e)=>{const i=new Map;return i.cleanup=t,i.computed=e,i},xe=new WeakMap,B=Symbol(""),Ce=Symbol("");function _(t,e,i){if(k&&z){let n=xe.get(t);n||xe.set(t,n=new Map);let r=n.get(i);r||n.set(i,r=it(()=>n.delete(i))),et(z,r)}}function P(t,e,i,n,r,s){const o=xe.get(t);if(!o)return;let l=[];if(e==="clear")l=[...o.values()];else if(i==="length"&&C(t)){const a=Number(n);o.forEach((c,u)=>{(u==="length"||!ye(u)&&u>=a)&&l.push(c)})}else switch(i!==void 0&&l.push(o.get(i)),e){case"add":C(t)?Re(i)&&l.push(o.get("length")):(l.push(o.get(B)),G(t)&&l.push(o.get(Ce)));break;case"delete":C(t)||(l.push(o.get(B)),G(t)&&l.push(o.get(Ce)));break;case"set":G(t)&&l.push(o.get(B));break}Me();for(const a of l)a&&tt(a,4);Ne()}const Ot=St("__proto__,__v_isRef,__isVue"),nt=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ye)),ze=Dt();function Dt(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...i){const n=p(this);for(let s=0,o=this.length;s<o;s++)_(n,"get",s+"");const r=n[e](...i);return r===-1||r===!1?n[e](...i.map(p)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...i){Qe(),Me();const n=p(this)[e].apply(this,i);return Ne(),Ze(),n}}),t}function Ht(t){const e=p(this);return _(e,"has",t),e.hasOwnProperty(t)}class rt{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,n){const r=this._isReadonly,s=this._isShallow;if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_isShallow")return s;if(i==="__v_raw")return n===(r?s?Gt:lt:s?Vt:ot).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=C(e);if(!r){if(o&&pe(ze,i))return Reflect.get(ze,i,n);if(i==="hasOwnProperty")return Ht}const l=Reflect.get(e,i,n);return(ye(i)?nt.has(i):Ot(i))||(r||_(e,"get",i),s)?l:$(l)?o&&Re(i)?l:l.value:Y(l)?r?ut(l):at(l):l}}class Wt extends rt{constructor(e=!1){super(!1,e)}set(e,i,n,r){let s=e[i];if(!this._isShallow){const a=Q(s);if(!ge(n)&&!Q(n)&&(s=p(s),n=p(n)),!C(e)&&$(s)&&!$(n))return a?!1:(s.value=n,!0)}const o=C(e)&&Re(i)?Number(i)<e.length:pe(e,i),l=Reflect.set(e,i,n,r);return e===p(r)&&(o?D(n,s)&&P(e,"set",i,n):P(e,"add",i,n)),l}deleteProperty(e,i){const n=pe(e,i);e[i];const r=Reflect.deleteProperty(e,i);return r&&n&&P(e,"delete",i,void 0),r}has(e,i){const n=Reflect.has(e,i);return(!ye(i)||!nt.has(i))&&_(e,"has",i),n}ownKeys(e){return _(e,"iterate",C(e)?"length":B),Reflect.ownKeys(e)}}class Ft extends rt{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const zt=new Wt,Bt=new Ft,ke=t=>t,Se=t=>Reflect.getPrototypeOf(t);function re(t,e,i=!1,n=!1){t=t.__v_raw;const r=p(t),s=p(e);i||(D(e,s)&&_(r,"get",e),_(r,"get",s));const{has:o}=Se(r),l=n?ke:i?Pe:Z;if(o.call(r,e))return l(t.get(e));if(o.call(r,s))return l(t.get(s));t!==r&&t.get(e)}function se(t,e=!1){const i=this.__v_raw,n=p(i),r=p(t);return e||(D(t,r)&&_(n,"has",t),_(n,"has",r)),t===r?i.has(t):i.has(t)||i.has(r)}function oe(t,e=!1){return t=t.__v_raw,!e&&_(p(t),"iterate",B),Reflect.get(t,"size",t)}function Be(t){t=p(t);const e=p(this);return Se(e).has.call(e,t)||(e.add(t),P(e,"add",t,t)),this}function $e(t,e){e=p(e);const i=p(this),{has:n,get:r}=Se(i);let s=n.call(i,t);s||(t=p(t),s=n.call(i,t));const o=r.call(i,t);return i.set(t,e),s?D(e,o)&&P(i,"set",t,e):P(i,"add",t,e),this}function je(t){const e=p(this),{has:i,get:n}=Se(e);let r=i.call(e,t);r||(t=p(t),r=i.call(e,t)),n&&n.call(e,t);const s=e.delete(t);return r&&P(e,"delete",t,void 0),s}function Ke(){const t=p(this),e=t.size!==0,i=t.clear();return e&&P(t,"clear",void 0,void 0),i}function le(t,e){return function(n,r){const s=this,o=s.__v_raw,l=p(o),a=e?ke:t?Pe:Z;return!t&&_(l,"iterate",B),o.forEach((c,u)=>n.call(r,a(c),a(u),s))}}function ae(t,e,i){return function(...n){const r=this.__v_raw,s=p(r),o=G(s),l=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,c=r[t](...n),u=i?ke:e?Pe:Z;return!e&&_(s,"iterate",a?Ce:B),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:l?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function R(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function $t(){const t={get(s){return re(this,s)},get size(){return oe(this)},has:se,add:Be,set:$e,delete:je,clear:Ke,forEach:le(!1,!1)},e={get(s){return re(this,s,!1,!0)},get size(){return oe(this)},has:se,add:Be,set:$e,delete:je,clear:Ke,forEach:le(!1,!0)},i={get(s){return re(this,s,!0)},get size(){return oe(this,!0)},has(s){return se.call(this,s,!0)},add:R("add"),set:R("set"),delete:R("delete"),clear:R("clear"),forEach:le(!0,!1)},n={get(s){return re(this,s,!0,!0)},get size(){return oe(this,!0)},has(s){return se.call(this,s,!0)},add:R("add"),set:R("set"),delete:R("delete"),clear:R("clear"),forEach:le(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=ae(s,!1,!1),i[s]=ae(s,!0,!1),e[s]=ae(s,!1,!0),n[s]=ae(s,!0,!0)}),[t,i,e,n]}const[jt,Kt,qt,Yt]=$t();function st(t,e){const i=e?t?Yt:qt:t?Kt:jt;return(n,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?n:Reflect.get(pe(i,r)&&r in n?i:n,r,s)}const Ut={get:st(!1,!1)},Xt={get:st(!0,!1)},ot=new WeakMap,Vt=new WeakMap,lt=new WeakMap,Gt=new WeakMap;function Jt(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Qt(t){return t.__v_skip||!Object.isExtensible(t)?0:Jt(At(t))}function at(t){return Q(t)?t:ct(t,!1,zt,Ut,ot)}function ut(t){return ct(t,!0,Bt,Xt,lt)}function ct(t,e,i,n,r){if(!Y(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=Qt(t);if(o===0)return t;const l=new Proxy(t,o===2?n:i);return r.set(t,l),l}function he(t){return Q(t)?he(t.__v_raw):!!(t&&t.__v_isReactive)}function Q(t){return!!(t&&t.__v_isReadonly)}function ge(t){return!!(t&&t.__v_isShallow)}function p(t){const e=t&&t.__v_raw;return e?p(e):t}const Z=t=>Y(t)?at(t):t,Pe=t=>Y(t)?ut(t):t;class Zt{constructor(e,i,n,r){this.getter=e,this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Ve(()=>e(this._value),()=>de(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const e=p(this);return(!e._cacheable||e.effect.dirty)&&D(e._value,e._value=e.effect.run())&&de(e,4),ht(e),e.effect._dirtyLevel>=2&&de(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function ht(t){var e;k&&z&&(t=p(t),et(z,(e=t.dep)!=null?e:t.dep=it(()=>t.dep=void 0,t instanceof Zt?t:void 0)))}function de(t,e=4,i){t=p(t);const n=t.dep;n&&tt(n,e)}function $(t){return!!(t&&t.__v_isRef===!0)}function dt(t){return ei(t,!1)}function ei(t,e){return $(t)?t:new ti(t,e)}class ti{constructor(e,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?e:p(e),this._value=i?e:Z(e)}get value(){return ht(this),this._value}set value(e){const i=this.__v_isShallow||ge(e)||Q(e);e=i?e:p(e),D(e,this._rawValue)&&(this._rawValue=e,this._value=i?e:Z(e),de(this,4))}}/**
* @vue/runtime-core v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function K(t,e,i,n){try{return n?t(...n):t()}catch(r){ft(r,e,i)}}function fe(t,e,i,n){if(F(t)){const s=K(t,e,i,n);return s&&It(s)&&s.catch(o=>{ft(o,e,i)}),s}const r=[];for(let s=0;s<t.length;s++)r.push(fe(t[s],e,i,n));return r}function ft(t,e,i,n=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${i}`;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,o,l)===!1)return}s=s.parent}const a=e.appContext.config.errorHandler;if(a){K(a,null,10,[t,o,l]);return}}ii(t,i,r,n)}function ii(t,e,i,n=!0){console.error(t)}let me=!1,Ie=!1;const x=[];let N=0;const q=[];let M=null,H=0;const pt=Promise.resolve();let Oe=null;function ee(t){const e=Oe||pt;return t?e.then(this?t.bind(this):t):e}function ni(t){let e=N+1,i=x.length;for(;e<i;){const n=e+i>>>1,r=x[n],s=te(r);s<t||s===t&&r.pre?e=n+1:i=n}return e}function ri(t){(!x.length||!x.includes(t,me&&t.allowRecurse?N+1:N))&&(t.id==null?x.push(t):x.splice(ni(t.id),0,t),gt())}function gt(){!me&&!Ie&&(Ie=!0,Oe=pt.then(mt))}function si(t){C(t)?q.push(...t):(!M||!M.includes(t,t.allowRecurse?H+1:H))&&q.push(t),gt()}function oi(t){if(q.length){const e=[...new Set(q)].sort((i,n)=>te(i)-te(n));if(q.length=0,M){M.push(...e);return}for(M=e,H=0;H<M.length;H++)M[H]();M=null,H=0}}const te=t=>t.id==null?1/0:t.id,li=(t,e)=>{const i=te(t)-te(e);if(i===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return i};function mt(t){Ie=!1,me=!0,x.sort(li);try{for(N=0;N<x.length;N++){const e=x[N];e&&e.active!==!1&&K(e,null,14)}}finally{N=0,x.length=0,oi(),me=!1,Oe=null,(x.length||q.length)&&mt()}}let ai=null;function ui(t,e){e&&e.pendingBranch?C(t)?e.effects.push(...t):e.effects.push(t):si(t)}const ci=Symbol.for("v-scx"),hi=()=>pi(ci),ue={};function di(t,e,i){return fi(t,e,i)}function fi(t,e,{immediate:i,deep:n,flush:r,once:s,onTrack:o,onTrigger:l}=Tt){if(e&&s){const f=e;e=(...L)=>{f(...L),S()}}const a=De,c=f=>n===!0?f:j(f,n===!1?1:void 0);let u,d=!1,h=!1;if($(t)?(u=()=>t.value,d=ge(t)):he(t)?(u=()=>c(t),d=!0):C(t)?(h=!0,d=t.some(f=>he(f)||ge(f)),u=()=>t.map(f=>{if($(f))return f.value;if(he(f))return c(f);if(F(f))return K(f,a,2)})):F(t)?e?u=()=>K(t,a,2):u=()=>(g&&g(),fe(t,a,3,[m])):u=ne,e&&n){const f=u;u=()=>j(f())}let g,m=f=>{g=y.onStop=()=>{K(f,a,4),g=y.onStop=void 0}},w;if(bt)if(m=ne,e?i&&fe(e,a,3,[u(),h?[]:void 0,m]):u(),r==="sync"){const f=hi();w=f.__watcherHandles||(f.__watcherHandles=[])}else return ne;let v=h?new Array(t.length).fill(ue):ue;const E=()=>{if(!(!y.active||!y.dirty))if(e){const f=y.run();(n||d||(h?f.some((L,A)=>D(L,v[A])):D(f,v)))&&(g&&g(),fe(e,a,3,[f,v===ue?void 0:h&&v[0]===ue?[]:v,m]),v=f)}else y.run()};E.allowRecurse=!!e;let I;r==="sync"?I=E:r==="post"?I=()=>Ye(E,a&&a.suspense):(E.pre=!0,a&&(E.id=a.uid),I=()=>ri(E));const y=new Ve(u,ne,I),S=()=>{y.stop()};return e?i?E():v=y.run():r==="post"?Ye(y.run.bind(y),a&&a.suspense):y.run(),w&&w.push(S),S}function j(t,e,i=0,n){if(!Y(t)||t.__v_skip)return t;if(e&&e>0){if(i>=e)return t;i++}if(n=n||new Set,n.has(t))return t;if(n.add(t),$(t))j(t.value,e,i,n);else if(C(t))for(let r=0;r<t.length;r++)j(t[r],e,i,n);else if(xt(t)||G(t))t.forEach(r=>{j(r,e,i,n)});else if(Rt(t))for(const r in t)j(t[r],e,i,n);return t}let qe=null;function pi(t,e,i=!1){const n=De||ai;if(n||qe){const r=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:qe._context.provides;if(r&&t in r)return r[t];if(arguments.length>1)return i&&F(e)?e.call(n&&n.proxy):e}}const Ye=ui;let De=null;{const t=Mt(),e=(i,n)=>{let r;return(r=t[i])||(r=t[i]=[]),r.push(n),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};e("__VUE_INSTANCE_SETTERS__",i=>De=i),e("__VUE_SSR_SETTERS__",i=>bt=i)}let bt=!1;var J=new Map;function gi(t){var e=J.get(t);e&&e.destroy()}function mi(t){var e=J.get(t);e&&e.update()}var V=null;typeof window>"u"?((V=function(t){return t}).destroy=function(t){return t},V.update=function(t){return t}):((V=function(t,e){return t&&Array.prototype.forEach.call(t.length?t:[t],function(i){return function(n){if(n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!J.has(n)){var r,s=null,o=window.getComputedStyle(n),l=(r=n.value,function(){c({testForHeightReduction:r===""||!n.value.startsWith(r),restoreTextAlign:null}),r=n.value}),a=function(d){n.removeEventListener("autosize:destroy",a),n.removeEventListener("autosize:update",u),n.removeEventListener("input",l),window.removeEventListener("resize",u),Object.keys(d).forEach(function(h){return n.style[h]=d[h]}),J.delete(n)}.bind(n,{height:n.style.height,resize:n.style.resize,textAlign:n.style.textAlign,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",a),n.addEventListener("autosize:update",u),n.addEventListener("input",l),window.addEventListener("resize",u),n.style.overflowX="hidden",n.style.wordWrap="break-word",J.set(n,{destroy:a,update:u}),u()}function c(d){var h,g,m=d.restoreTextAlign,w=m===void 0?null:m,v=d.testForHeightReduction,E=v===void 0||v,I=o.overflowY;if(n.scrollHeight!==0&&(o.resize==="vertical"?n.style.resize="none":o.resize==="both"&&(n.style.resize="horizontal"),E&&(h=function(S){for(var f=[];S&&S.parentNode&&S.parentNode instanceof Element;)S.parentNode.scrollTop&&f.push([S.parentNode,S.parentNode.scrollTop]),S=S.parentNode;return function(){return f.forEach(function(L){var A=L[0],ie=L[1];A.style.scrollBehavior="auto",A.scrollTop=ie,A.style.scrollBehavior=null})}}(n),n.style.height=""),g=o.boxSizing==="content-box"?n.scrollHeight-(parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)):n.scrollHeight+parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth),o.maxHeight!=="none"&&g>parseFloat(o.maxHeight)?(o.overflowY==="hidden"&&(n.style.overflow="scroll"),g=parseFloat(o.maxHeight)):o.overflowY!=="hidden"&&(n.style.overflow="hidden"),n.style.height=g+"px",w&&(n.style.textAlign=w),h&&h(),s!==g&&(n.dispatchEvent(new Event("autosize:resized",{bubbles:!0})),s=g),I!==o.overflow&&!w)){var y=o.textAlign;o.overflow==="hidden"&&(n.style.textAlign=y==="start"?"end":"start"),c({restoreTextAlign:y,testForHeightReduction:!0})}}function u(){c({testForHeightReduction:!0,restoreTextAlign:null})}}(i)}),t}).destroy=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],gi),t},V.update=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],mi),t});var vt=V;Array.prototype.find||(Array.prototype.find=function(t){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof t!="function")throw new TypeError("predicate must be a function");for(var e=Object(this),i=e.length>>>0,n=arguments[1],r,s=0;s<i;s++)if(r=e[s],t.call(n,r,s,e))return r});if(window&&typeof window.CustomEvent!="function"){let t=function(e,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,i.bubbles,i.cancelable,i.detail),n};var xi=t;typeof window.Event<"u"&&(t.prototype=window.Event.prototype),window.CustomEvent=t}class be{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}unbind(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(e,i){e.shouldDeactivate(i)&&(e.tribute.isActive=!1,e.tribute.hideMenu());let n=this;e.commandEvent=!1,be.keys().forEach(r=>{r.key===i.keyCode&&(e.commandEvent=!0,e.callbacks()[r.value.toLowerCase()](i,n))})}input(e,i){e.inputEvent=!0,e.keyup.call(this,e,i)}click(e,i){let n=e.tribute;if(n.menu&&n.menu.contains(i.target)){let r=i.target;for(i.preventDefault(),i.stopPropagation();r.nodeName.toLowerCase()!=="li";)if(r=r.parentNode,!r||r===n.menu)throw new Error("cannot find the <li> container for the click");n.selectItemAtIndex(r.getAttribute("data-index"),i),n.hideMenu()}else n.current.element&&!n.current.externalTrigger&&(n.current.externalTrigger=!1,setTimeout(()=>n.hideMenu()))}keyup(e,i){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),i.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(i,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(i,this,"");else{let n=e.getKeyCode(e,this,i);if(isNaN(n)||!n)return;let r=e.tribute.triggers().find(s=>s.charCodeAt(0)===n);typeof r<"u"&&e.callbacks().triggerChar(i,this,r)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&i.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(e){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let i=!1;return be.keys().forEach(n=>{e.keyCode===n.key&&(i=!0)}),!i}return!1}getKeyCode(e,i,n){let r=e.tribute,s=r.range.getTriggerInfo(!1,r.hasTrailingSpace,!0,r.allowSpaces,r.autocompleteMode);return s?s.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let i=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);i&&(this.tribute.current.selectedPath=i.mentionSelectedPath,this.tribute.current.mentionText=i.mentionText,this.tribute.current.selectedOffset=i.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,i,n)=>{let r=this.tribute;r.current.trigger=n;let s=r.collection.find(o=>o.trigger===n);r.current.collection=s,r.current.mentionText.length>=r.current.collection.menuShowMinLength&&r.inputEvent&&r.showMenuFor(i,!0)},enter:(e,i)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,i)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,i)=>{this.callbacks().enter(e,i)},space:(e,i)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,i):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,i)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length,r=this.tribute.menuSelected;n>r&&r>0?(this.tribute.menuSelected--,this.setActiveLi()):r===0&&(this.tribute.menuSelected=n-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,i)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length-1,r=this.tribute.menuSelected;n>r?(this.tribute.menuSelected++,this.setActiveLi()):n===r&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,i)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(i)}}}setActiveLi(e){let i=this.tribute.menu.querySelectorAll("li"),n=i.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let r=0;r<n;r++){let s=i[r];if(r===this.tribute.menuSelected){s.classList.add(this.tribute.current.collection.selectClass);let o=s.getBoundingClientRect(),l=this.tribute.menu.getBoundingClientRect();if(o.bottom>l.bottom){let a=o.bottom-l.bottom;this.tribute.menu.scrollTop+=a}else if(o.top<l.top){let a=l.top-o.top;this.tribute.menu.scrollTop-=a}}else s.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,i){let n=e.getBoundingClientRect().height;if(i){let r=e.currentStyle||window.getComputedStyle(e);return n+parseFloat(r.marginTop)+parseFloat(r.marginBottom)}return n}}class bi{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.hideMenu()},10,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.hideMenu()},10,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}debounce(e,i,n){var r;return()=>{var s=this,o=arguments,l=()=>{r=null,n||e.apply(s,o)},a=n&&!r;clearTimeout(r),r=setTimeout(l,i),a&&e.apply(s,o)}}}class vi{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let i=this.tribute.current,n,r=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof r<"u"){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText="display: block;";return}this.isContentEditable(i.element)?n=this.getContentEditableCaretPosition(r.mentionPosition):n=this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,r.mentionPosition),this.tribute.menu.style.cssText=`top: ${n.top}px;
                                     left: ${n.left}px;
                                     right: ${n.right}px;
                                     bottom: ${n.bottom}px;
                                     max-height: ${n.maxHeight||500}px;
                                     max-width: ${n.maxWidth||300}px;
                                     position: ${n.position||"absolute"};
                                     display: block;`,n.left==="auto"&&(this.tribute.menu.style.left="auto"),n.top==="auto"&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView()}else this.tribute.menu.style.cssText="display: none"}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,i,n){let r,s=e;if(i)for(var o=0;o<i.length;o++){if(s=s.childNodes[i[o]],s===void 0)return;for(;s.length<n;)n-=s.length,s=s.nextSibling;s.childNodes.length===0&&!s.length&&(s=s.previousSibling)}let l=this.getWindowSelection();r=this.getDocument().createRange(),r.setStart(s,n),r.setEnd(s,n),r.collapse(!0);try{l.removeAllRanges()}catch{}l.addRange(r),e.focus()}replaceTriggerText(e,i,n,r,s){let o=this.getTriggerInfo(!0,n,i,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(o!==void 0){let l=this.tribute.current,a=new CustomEvent("tribute-replaced",{detail:{item:s,instance:l,context:o,event:r}});if(this.isContentEditable(l.element)){let c=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=c;let u=o.mentionPosition+o.mentionText.length;this.tribute.autocompleteMode||(u+=o.mentionTriggerChar.length),this.pasteHtml(e,o.mentionPosition,u)}else{let c=this.tribute.current.element,u=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=u;let d=o.mentionPosition,h=o.mentionPosition+o.mentionText.length+u.length;this.tribute.autocompleteMode||(h+=o.mentionTriggerChar.length-1),c.value=c.value.substring(0,d)+e+c.value.substring(h,c.value.length),c.selectionStart=d+e.length,c.selectionEnd=d+e.length}l.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),l.element.dispatchEvent(a)}}pasteHtml(e,i,n){let r,s;s=this.getWindowSelection(),r=this.getDocument().createRange(),r.setStart(s.anchorNode,i),r.setEnd(s.anchorNode,n),r.deleteContents();let o=this.getDocument().createElement("div");o.innerHTML=e;let l=this.getDocument().createDocumentFragment(),a,c;for(;a=o.firstChild;)c=l.appendChild(a);r.insertNode(l),c&&(r=r.cloneRange(),r.setStartAfter(c),r.collapse(!0),s.removeAllRanges(),s.addRange(r))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var i=0;i<e.parentNode.childNodes.length;i++)if(e.parentNode.childNodes[i]===e)return i}getContentEditableSelectedPath(e){let i=this.getWindowSelection(),n=i.anchorNode,r=[],s;if(n!=null){let o,l=n.contentEditable;for(;n!==null&&l!=="true";)o=this.getNodePositionInParent(n),r.push(o),n=n.parentNode,n!==null&&(l=n.contentEditable);return r.reverse(),s=i.getRangeAt(0).startOffset,{selected:n,path:r,offset:s}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,i="";if(this.isContentEditable(e.element)){let n=this.getWindowSelection().anchorNode;if(n!=null){let r=n.textContent,s=this.getWindowSelection().getRangeAt(0).startOffset;r&&s>=0&&(i=r.substring(0,s))}}else{let n=this.tribute.current.element;if(n){let r=n.selectionStart;n.value&&r>=0&&(i=n.value.substring(0,r))}}return i}getLastWordInText(e){e=e.replace(/\u00A0/g," ");var i;this.tribute.autocompleteSeparator?i=e.split(this.tribute.autocompleteSeparator):i=e.split(/\s+/);var n=i.length-1;return i[n].trim()}getTriggerInfo(e,i,n,r,s){let o=this.tribute.current,l,a,c;if(!this.isContentEditable(o.element))l=this.tribute.current.element;else{let h=this.getContentEditableSelectedPath(o);h&&(l=h.selected,a=h.path,c=h.offset)}let u=this.getTextPrecedingCurrentSelection(),d=this.getLastWordInText(u);if(s)return{mentionPosition:u.length-d.length,mentionText:d,mentionSelectedElement:l,mentionSelectedPath:a,mentionSelectedOffset:c};if(u!=null){let h=-1,g;if(this.tribute.collection.forEach(m=>{let w=m.trigger,v=m.requireLeadingSpace?this.lastIndexWithLeadingSpace(u,w):u.lastIndexOf(w);v>h&&(h=v,g=w,n=m.requireLeadingSpace)}),h>=0&&(h===0||!n||/[\xA0\s]/g.test(u.substring(h-1,h)))){let m=u.substring(h+g.length,u.length);g=u.substring(h,h+g.length);let w=m.substring(0,1),v=m.length>0&&(w===" "||w===" ");i&&(m=m.trim());let E=r?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=E.test(m),!v&&(e||!E.test(m)))return{mentionPosition:h,mentionText:m,mentionSelectedElement:l,mentionSelectedPath:a,mentionSelectedOffset:c,mentionTriggerChar:g}}}}lastIndexWithLeadingSpace(e,i){let n=e.split("").reverse().join(""),r=-1;for(let s=0,o=e.length;s<o;s++){let l=s===e.length-1,a=/\s/.test(n[s+1]),c=!0;for(let u=i.length-1;u>=0;u--)if(i[u]!==n[s-u]){c=!1;break}if(c&&(l||a)){r=e.length-1-s;break}}return r}isContentEditable(e){return e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"}isMenuOffScreen(e,i){let n=window.innerWidth,r=window.innerHeight,s=document.documentElement,o=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),l=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),a=typeof e.top=="number"?e.top:l+r-e.bottom-i.height,c=typeof e.right=="number"?e.right:e.left+i.width,u=typeof e.bottom=="number"?e.bottom:e.top+i.height,d=typeof e.left=="number"?e.left:o+n-e.right-i.width;return{top:a<Math.floor(l),right:c>Math.ceil(o+n),bottom:u>Math.ceil(l+r),left:d<Math.floor(o)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;
                                 max-height:500px;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}getTextAreaOrInputUnderlinePosition(e,i,n){let r=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],s=this.getDocument().createElement("div");s.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(s);let o=s.style,l=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap",e.nodeName!=="INPUT"&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",r.forEach(g=>{o[g]=l[g]});let a=document.createElement("span");a.textContent=e.value.substring(0,i),s.appendChild(a),e.nodeName==="INPUT"&&(s.textContent=s.textContent.replace(/\s/g," "));let c=this.getDocument().createElement("span");c.textContent="&#x200B;",s.appendChild(c);let u=this.getDocument().createElement("span");u.textContent=e.value.substring(i),s.appendChild(u);let d=e.getBoundingClientRect();s.style.position="fixed",s.style.left=d.left+"px",s.style.top=d.top+"px",s.style.width=d.width+"px",s.style.height=d.height+"px",s.scrollTop=e.scrollTop;var h=c.getBoundingClientRect();return this.getDocument().body.removeChild(s),this.getFixedCoordinatesRelativeToRect(h)}getContentEditableCaretPosition(e){let i,n=this.getWindowSelection();i=this.getDocument().createRange(),i.setStart(n.anchorNode,e),i.setEnd(n.anchorNode,e),i.collapse(!1);let r=i.getBoundingClientRect();return this.getFixedCoordinatesRelativeToRect(r)}getFixedCoordinatesRelativeToRect(e){let i={position:"fixed",left:e.left,top:e.top+e.height},n=this.getMenuDimensions();var r=e.top,s=window.innerHeight-(e.top+e.height);s<n.height&&(r>=n.height||r>s?(i.top="auto",i.bottom=window.innerHeight-e.top,s<n.height&&(i.maxHeight=r)):r<n.height&&(i.maxHeight=s));var o=e.left,l=window.innerWidth-e.left;return l<n.width&&(o>=n.width||o>l?(i.left="auto",i.right=window.innerWidth-e.left,l<n.width&&(i.maxWidth=o)):o<n.width&&(i.maxWidth=l)),i}scrollIntoView(e){let i=20,n,r=100,s=this.menu;if(typeof s>"u")return;for(;n===void 0||n.height===0;)if(n=s.getBoundingClientRect(),n.height===0&&(s=s.childNodes[0],s===void 0||!s.getBoundingClientRect))return;let o=n.top,l=o+n.height;if(o<0)window.scrollTo(0,window.pageYOffset+n.top-i);else if(l>window.innerHeight){let a=window.pageYOffset+n.top-i;a-window.pageYOffset>r&&(a=window.pageYOffset+r);let c=window.pageYOffset-(window.innerHeight-l);c>a&&(c=a),window.scrollTo(0,c)}}}class wi{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,i){return i.filter(n=>this.test(e,n))}test(e,i){return this.match(e,i)!==null}match(e,i,n){n=n||{},i.length;let r=n.pre||"",s=n.post||"",o=n.caseSensitive&&i||i.toLowerCase();if(n.skip)return{rendered:i,score:0};e=n.caseSensitive&&e||e.toLowerCase();let l=this.traverse(o,e,0,0,[]);return l?{rendered:this.render(i,l.cache,r,s),score:l.score}:null}traverse(e,i,n,r,s){if(this.tribute.autocompleteSeparator&&(i=i.split(this.tribute.autocompleteSeparator).splice(-1)[0]),i.length===r)return{score:this.calculateScore(s),cache:s.slice()};if(e.length===n||i.length-r>e.length-n)return;let o=i[r],l=e.indexOf(o,n),a,c;for(;l>-1;){if(s.push(l),c=this.traverse(e,i,l+1,r+1,s),s.pop(),!c)return a;(!a||a.score<c.score)&&(a=c),l=e.indexOf(o,l+1)}return a}calculateScore(e){let i=0,n=1;return e.forEach((r,s)=>{s>0&&(e[s-1]+1===r?n+=n+1:n=1),i+=n}),i}render(e,i,n,r){var s=e.substring(0,i[0]);return i.forEach((o,l)=>{s+=n+e[o]+r+e.substring(o+1,i[l+1]?i[l+1]:e.length)}),s}filter(e,i,n){return n=n||{},i.reduce((r,s,o,l)=>{let a=s;n.extract&&(a=n.extract(s),a||(a=""));let c=this.match(e,a,n);return c!=null&&(r[r.length]={string:c.rendered,score:c.score,index:o,original:s}),r},[]).sort((r,s)=>{let o=s.score-r.score;return o||r.index-s.index})}}class W{constructor({values:e=null,loadingItemTemplate:i=null,iframe:n=null,selectClass:r="highlight",containerClass:s="tribute-container",itemClass:o="",trigger:l="@",autocompleteMode:a=!1,autocompleteSeparator:c=null,selectTemplate:u=null,menuItemTemplate:d=null,lookup:h="key",fillAttr:g="value",collection:m=null,menuContainer:w=null,noMatchTemplate:v=null,requireLeadingSpace:E=!0,allowSpaces:I=!1,replaceTextSuffix:y=null,positionMenu:S=!0,spaceSelectsMatch:f=!1,searchOpts:L={},menuItemLimit:A=null,menuShowMinLength:ie=0}){if(this.autocompleteMode=a,this.autocompleteSeparator=c,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=w,this.allowSpaces=I,this.replaceTextSuffix=y,this.positionMenu=S,this.hasTrailingSpace=!1,this.spaceSelectsMatch=f,this.autocompleteMode&&(l="",I=!1),e)this.collection=[{trigger:l,iframe:n,selectClass:r,containerClass:s,itemClass:o,selectTemplate:(u||W.defaultSelectTemplate).bind(this),menuItemTemplate:(d||W.defaultMenuItemTemplate).bind(this),noMatchTemplate:(b=>typeof b=="string"?b.trim()===""?null:b:typeof b=="function"?b.bind(this):v||function(){return"<li>No Match Found!</li>"}.bind(this))(v),lookup:h,fillAttr:g,values:e,loadingItemTemplate:i,requireLeadingSpace:E,searchOpts:L,menuItemLimit:A,menuShowMinLength:ie}];else if(m)this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=m.map(b=>({trigger:b.trigger||l,iframe:b.iframe||n,selectClass:b.selectClass||r,containerClass:b.containerClass||s,itemClass:b.itemClass||o,selectTemplate:(b.selectTemplate||W.defaultSelectTemplate).bind(this),menuItemTemplate:(b.menuItemTemplate||W.defaultMenuItemTemplate).bind(this),noMatchTemplate:(X=>typeof X=="string"?X.trim()===""?null:X:typeof X=="function"?X.bind(this):v||function(){return"<li>No Match Found!</li>"}.bind(this))(v),lookup:b.lookup||h,fillAttr:b.fillAttr||g,values:b.values,loadingItemTemplate:b.loadingItemTemplate,requireLeadingSpace:b.requireLeadingSpace,searchOpts:b.searchOpts||L,menuItemLimit:b.menuItemLimit||A,menuShowMinLength:b.menuShowMinLength||ie}));else throw new Error("[Tribute] No collection specified.");new vi(this),new be(this),new bi(this),new wi(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let i=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(i)}}static defaultSelectTemplate(e){return typeof e>"u"?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return["TEXTAREA","INPUT"]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var i=0;i<n;++i)this._attach(e[i])}else this._attach(e)}_attach(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}ensureEditable(e){if(W.inputTypes().indexOf(e.nodeName)===-1)if(e.contentEditable)e.contentEditable=!0;else throw new Error("[Tribute] Cannot bind to "+e.nodeName)}createMenu(e){let i=this.range.getDocument().createElement("div"),n=this.range.getDocument().createElement("ul");return i.className=e,i.appendChild(n),this.menuContainer?this.menuContainer.appendChild(i):this.range.getDocument().body.appendChild(i)}showMenuFor(e,i){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");const n=r=>{if(!this.isActive)return;let s=this.search.filter(this.current.mentionText,r,{pre:this.current.collection.searchOpts.pre||"<span>",post:this.current.collection.searchOpts.post||"</span>",skip:this.current.collection.searchOpts.skip,extract:a=>{if(typeof this.current.collection.lookup=="string")return a[this.current.collection.lookup];if(typeof this.current.collection.lookup=="function")return this.current.collection.lookup(a,this.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});this.current.collection.menuItemLimit&&(s=s.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=s;let o=this.menu.querySelector("ul");if(!s.length){let a=new CustomEvent("tribute-no-match",{detail:this.menu});this.current.element.dispatchEvent(a),typeof this.current.collection.noMatchTemplate=="function"&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():(typeof this.current.collection.noMatchTemplate=="function"?o.innerHTML=this.current.collection.noMatchTemplate():o.innerHTML=this.current.collection.noMatchTemplate,this.range.positionMenuAtCaret(i));return}o.innerHTML="";let l=this.range.getDocument().createDocumentFragment();s.forEach((a,c)=>{let u=this.range.getDocument().createElement("li");u.setAttribute("data-index",c),u.className=this.current.collection.itemClass,u.addEventListener("mousemove",d=>{let[h,g]=this._findLiTarget(d.target);d.movementY!==0&&this.events.setActiveLi(g)}),this.menuSelected===c&&u.classList.add(this.current.collection.selectClass),u.innerHTML=this.current.collection.menuItemTemplate(a),l.appendChild(u)}),o.appendChild(l),this.range.positionMenuAtCaret(i)};typeof this.current.collection.values=="function"?(this.current.collection.loadingItemTemplate&&(this.menu.querySelector("ul").innerHTML=this.current.collection.loadingItemTemplate,this.range.positionMenuAtCaret(i)),this.current.collection.values(this.current.mentionText,n)):n(this.current.collection.values)}_findLiTarget(e){if(!e)return[];const i=e.getAttribute("data-index");return i?[e,i]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,i){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[i||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u"){var i=document.createRange();i.selectNodeContents(e),i.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(i)}else if(typeof document.body.createTextRange<"u"){var r=document.body.createTextRange();r.moveToElementText(e),r.collapse(!1),r.select()}}insertTextAtCursor(e){var i,n;i=window.getSelection(),n=i.getRangeAt(0),n.deleteContents();var r=document.createTextNode(e);n.insertNode(r),n.selectNodeContents(r),n.collapse(!1),i.removeAllRanges(),i.addRange(n)}insertAtCaret(e,i){var n=e.scrollTop,r=e.selectionStart,s=e.value.substring(0,r),o=e.value.substring(e.selectionEnd,e.value.length);e.value=s+i+o,r=r+i.length,e.selectionStart=r,e.selectionEnd=r,e.focus(),e.scrollTop=n}hideMenu(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,i){if(e=parseInt(e),typeof e!="number"||isNaN(e))return;let n=this.current.filteredItems[e],r=this.current.collection.selectTemplate(n);r!==null&&this.replaceText(r,i,n)}replaceText(e,i,n){this.range.replaceTriggerText(e,!0,!0,i,n)}_append(e,i,n){if(typeof e.values=="function")throw new Error("Unable to append to values, as it is a function.");n?e.values=i:e.values=e.values.concat(i)}append(e,i,n){let r=parseInt(e);if(typeof r!="number")throw new Error("please provide an index for the collection to update.");let s=this.collection[r];this._append(s,i,n)}appendCurrent(e,i){if(this.isActive)this._append(this.current.collection,e,i);else throw new Error("No active state. Please use append instead and pass an index.")}detach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var i=0;i<n;++i)this._detach(e[i])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute("data-tribute"),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}}function ve(t,e){this.init(t,e)}ve.instance=function(t,e){return new ve(t,e)};ve.prototype={ID:"hit",init:function(t,e){typeof t=="string"?this.el=document.querySelector(t):this.el=t,this.getType(e)==="custom"?(this.highlight=e,this.generate()):console.error("valid config object not provided")},getType:function(t){let e=typeof t;if(t){if(Array.isArray(t))return t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"?"range":"array";if(e==="object"){if(t instanceof RegExp)return"regexp";if(t.hasOwnProperty("highlight"))return"custom"}else if(e==="function"||e==="string")return e}else return"falsey";return"other"},generate:function(){this.el.classList.add(this.ID+"-input",this.ID+"-content"),this.el.addEventListener("input",this.handleInput.bind(this)),this.el.addEventListener("scroll",this.handleScroll.bind(this)),this.highlights=document.createElement("div"),this.highlights.classList.add(this.ID+"-highlights",this.ID+"-content"),this.backdrop=document.createElement("div"),this.backdrop.classList.add(this.ID+"-backdrop"),this.backdrop.append(this.highlights),this.container=document.createElement("div"),this.container.classList.add(this.ID+"-container"),this.el.parentNode.insertBefore(this.container,this.el.nextSibling),this.container.append(this.backdrop),this.container.append(this.el),this.container.addEventListener("scroll",this.blockContainerScroll.bind(this)),this.handleInput()},handleInput:function(){let t=this.el.value,e=this.getRanges(t,this.highlight),i=this.removeStaggeredRanges(e),n=this.getBoundaries(i);this.renderMarks(n)},getRanges:function(t,e){switch(this.getType(e)){case"array":return this.getArrayRanges(t,e);case"function":return this.getFunctionRanges(t,e);case"regexp":return this.getRegExpRanges(t,e);case"string":return this.getStringRanges(t,e);case"range":return this.getRangeRanges(t,e);case"custom":return this.getCustomRanges(t,e);default:if(e)console.error("unrecognized highlight type");else return[]}},getArrayRanges:function(t,e){let i=e.map(this.getRanges.bind(this,t));return Array.prototype.concat.apply([],i)},getFunctionRanges:function(t,e){return this.getRanges(t,e(t))},getRegExpRanges:function(t,e){let i=[],n;for(;(n=e.exec(t),n!==null)&&(i.push([n.index,n.index+n[0].length]),!!e.global););return i},getStringRanges:function(t,e){let i=[],n=t.toLowerCase(),r=e.toLowerCase(),s=0;for(;s=n.indexOf(r,s),s!==-1;)i.push([s,s+r.length]),s+=r.length;return i},getRangeRanges:function(t,e){return[e]},getCustomRanges:function(t,e){let i=this.getRanges(t,e.highlight);return e.className&&i.forEach(function(n){n.className?n.className=e.className+" "+n.className:n.className=e.className}),e.blank&&i.forEach(function(n){n.blank=e.blank}),i},removeStaggeredRanges:function(t){let e=[];return t.forEach(function(i){e.some(function(r){let s=i[0]>r[0]&&i[0]<r[1],o=i[1]>r[0]&&i[1]<r[1];return s!==o})||e.push(i)}),e},getBoundaries:function(t){let e=[];return t.forEach(function(i){e.push({type:"start",index:i[0],className:i.className,blank:i.blank}),e.push({type:"stop",index:i[1]})}),this.sortBoundaries(e),e},sortBoundaries:function(t){t.sort(function(e,i){return e.index!==i.index?i.index-e.index:e.type==="stop"&&i.type==="start"?1:e.type==="start"&&i.type==="stop"?-1:0})},renderMarks:function(t){let e=this.el.value;t.forEach(function(i,n){let r;i.type==="start"?r="{{hit-mark-start|"+n+"}}":r="{{hit-mark-stop}}",e=e.slice(0,i.index)+r+e.slice(i.index)}),e=e.replace(/\n({{hit-mark-stop}})?$/,`

$1`),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/{{hit-mark-start\|(\d+)}}/g,function(i,n){const r=t[+n].className;return r?'<mark class="'+r+'">':"<mark>"}),e=e.replace(/{{hit-mark-stop}}/g,"</mark>"),e+='<mark class="placeholder"> ⚡ </mark>',this.highlights.innerHTML=e},handleScroll:function(){this.backdrop.scrollTop=this.el.scrollTop;let t=this.el.scrollLeft;t>0?this.backdrop.style.transform="translateX("+-t+"px)":this.backdrop.style.transform=""},blockContainerScroll:function(){this.container.scrollLeft=0},destroy:function(){this.container.parentElement.replaceChild(this.el,this.container),this.el.classList.remove(this.ID+"-content",this.ID+"-input")}};const yi=document.getElementById("bricks-builder-iframe"),we=document.querySelector(".brx-body").__vue_app__.config.globalProperties,O=yi.contentDocument.querySelector(".brx-body").__vue_app__.config.globalProperties,T=document.createElement("textarea");T.classList.add("bricksbender-input");T.setAttribute("rows","1");T.setAttribute("spellcheck","false");const Le=dt(!1),Ae=dt(null);let wt=null;vt(T);let yt=[];wp.hooks.addAction("bricksbender-autocomplete-items-refresh","bricksbender",()=>{yt=wp.hooks.applyFilters("bricksbender-autocomplete-items",[],T.value)});wp.hooks.doAction("bricksbender-autocomplete-items-refresh");const U=new W({containerClass:"bricksbender-tribute-container",autocompleteMode:!0,menuItemLimit:30,noMatchTemplate:"",values:async function(t,e){const i=await wp.hooks.applyFilters("bricksbender-autocomplete-items-query",yt,t);e(i)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(t){let e="";return t.original.color!==void 0&&(e+=`background-color: ${t.original.color};`),t.original.fontWeight!==void 0&&(e+=`font-weight: ${t.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${t.original.value}">${t.string}</span>
            <span class="class-hint" style="${e}"></span>
        `}});U.setMenuContainer=function(t){this.menuContainer=t};const Ei=U.events.callbacks;U.events.callbacks=function(){return{...Ei.call(this),up:(t,e)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){t.preventDefault(),t.stopPropagation();let i=this.tribute.current.filteredItems.length,n=this.tribute.menuSelected;i>n&&n>0?(this.tribute.menuSelected--,this.setActiveLi()):n===0&&(this.tribute.menuSelected=i-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),Xe()}},down:(t,e)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){t.preventDefault(),t.stopPropagation();let i=this.tribute.current.filteredItems.length-1,n=this.tribute.menuSelected;i>n?(this.tribute.menuSelected++,this.setActiveLi()):i===n&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),Xe()}}}};U.attach(T);const Si=new MutationObserver(function(t){t.forEach(function(e){e.type==="attributes"?e.target.id==="bricks-panel-element"&&e.attributeName==="style"?e.target.style.display!=="none"?Le.value=!0:Le.value=!1:e.attributeName==="placeholder"&&e.target.tagName==="INPUT"&&e.target.classList.contains("placeholder")&&(Ae.value=we.$_activeElement.value.id):e.type==="childList"&&e.addedNodes.length>0&&(e.target.id==="bricks-panel-sticky"&&e.addedNodes[0].id==="bricks-panel-element-classes"?Ae.value=we.$_activeElement.value.id:e.target.dataset&&e.target.dataset.controlkey==="_cssClasses"&&e.addedNodes[0].childNodes.length>0&&document.querySelector("#_cssClasses").addEventListener("input",function(i){ee(()=>{T.value=i.target.value,Et()})}))})});Si.observe(document.getElementById("bricks-panel-element"),{subtree:!0,attributes:!0,childList:!0});di([Ae,Le],(t,e)=>{t[0]!==e[0]&&ee(()=>{T.value=we.$_activeElement.value.settings._cssClasses||"",Et()}),t[0]&&t[1]&&ee(()=>{const i=document.querySelector("#bricks-panel-element-classes");i.querySelector(".bricksbender-input")===null&&(i.appendChild(T),wt=new ve(T,{highlight:[{highlight:/(?<=\s|^)(?:(?!\s).)+(?=\s|$)/g,className:"word"},{highlight:/(?<=\s)\s/g,className:"multispace",blank:!0}]}))})});T.addEventListener("input",function(t){we.$_activeElement.value.settings._cssClasses=t.target.value});function Et(){ee(()=>{try{wt.handleInput()}catch{}vt.update(T),U.hideMenu()})}const Ti=new MutationObserver(function(t){t.forEach(function(e){e.type==="childList"&&e.addedNodes.length>0&&e.addedNodes.forEach(i=>{const n=i.querySelector(".class-name").dataset.tributeClassName;i.addEventListener("mouseenter",r=>{_i(n)}),i.addEventListener("mouseleave",r=>{Ue()}),i.addEventListener("click",r=>{Ue()})})})});let ce=null;T.addEventListener("tribute-active-true",function(t){ce===null&&(ce=document.querySelector(".bricksbender-tribute-container>ul")),ee(()=>{ce&&Ti.observe(ce,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})});function _i(t){O.$_getElementNode(O.$_activeElement.value).classList.add(t)}function Ue(){const t=O.$_activeElement.value,e=O.$_getElementNode(t),i=O.$_getElementClasses(t);e.classList.value=i.join(" ")}function Xe(){let t=U.menu.querySelector("li.highlight>span.class-name");const e=O.$_activeElement.value,i=O.$_getElementNode(e),n=O.$_getElementClasses(e);i.classList.value=n.join(" ")+" "+t.dataset.tributeClassName}
